### 用途
  本軟體是一個程式語言MIP(macro interactive processing)及其操作介面，
  它幫你處理巨集、轉換二維資料表、快速產生程式給公司各員工使用。
  它幫助你傳遞資料，從這機器這資料庫到另一機器另一資料庫。
  它也幫助你寫出圖形辨認的程式，用來自動下圍棋。
  本軟體的整個目的是縮短程式碼，提升資訊人員的生產力，
  所以本軟體稱為MIP builder.
  
  在2000年初，我看到某資訊人員每天都在下SQL指令，來應付user的各種需求，
  他說user的需求變來變去很難寫成程式。要是有一個網頁型的SQL輸入框，
  讓他任意調整參數，調到滿意存起來就自動成為user的功能，這樣才能容易過活。
  於是我作了一個產出程式的母機，這就是MIP的出發點，也是MIP最主要的應用。
  本文將應用MIP建造四個軟體系統做為例子: 
  進銷退存系統，倉庫撿貨系統，問卷系統，資料傳輸系統。

  這十幾年來，資訊界流行一些越來越長的程式語言，以c#或java為例，
  執行一句SQL要先寫一大堆字，這些都是固定字，等於是一串固定的咒語，
  既是咒語，難道不能簡化成短語嗎?我只好把長咒語視為低階機器語言，
  利用MIP內含的特性(巨集、宏、macro)呼叫它們，
  一次產生幾十個長程式，這樣MIP就應用為一個預處理器。

  這幾年流行的程式語又更長了，程式中不斷宣告物件的屬性。
  1個屬性佔1行，1個物件有9個屬性，5個物件就45行， 
  這些物件都長得很像，整篇程式看起來就幾個字不斷的繞口令。
  難道我們不能把它排成9乘5的矩陣，讓文字簡潔清楚嗎?所以我讓MIP有操作矩陣的能力。
  若進一步把圍棋的點位視為矩陣，那麼利用MIP來寫圖形辨認的程式就容易了，
  MIP不必掛一堆黑箱library，也不必用昂貴的機器。
  
  本文從MIP的基本指令開始說明，延伸到談及這些應用。
  
### 安裝  
  本軟體由1個程式檔(webc.aspx)以及3個參數設定檔
  (cDBlist.txt, cSPlist.txt, cUSlist.txt)構成。
  本軟體只適合在windows+IIS作業環境下使用，安裝時，對著要安裝的電腦
  建子目錄c:\MIP\webc ，複製貼入以上4個檔案。
  建子目錄c:\MIP\webd ，備用，此目錄要允許IIS寫入資料，
  建子目錄c:\MIP\webt ，備用，此目錄要允許IIS寫入資料，
  建子目錄c:\MIP\webq ，備用，此目錄要允許IIS寫入資料，
  接著尋找這電腦上該有的IIS管理員，
    若看不到IIS卻看到伺服器管理員，點進去看到角色，
    角色下有網頁伺服器， 按右鍵新增角色服務，就可顯示IIS
  接著在IIS裡建立虛擬目錄webc，使實際位置指向 c:\MIP\webc
  接著打開瀏覽器，網址打localhost/webc/webc.aspx，
  看到請你登入的畫面即安裝完成。
  
  可能出現的問題:  看不到登入畫面， 看到: HTTP錯誤404.17 - 無法由靜態文件處理程序來處理
  解決方法:        應檢查ASP.NET有沒有安裝，也就是
                   控制面板》程序和功能》打開或關閉Windows功能> Internet信息服務> 網際網路服務> 應用程序開發功能> ASP.NET（把這個勾選起來）
    
  可能出現的問題:  對某目錄設定共用後 IIS報錯說 虛擬目錄不存在 說沒有web.config
  解決方法:        不須添加web.config ，只要進iis-manager 按右鍵> 管理虛擬目錄> 進階設定> 實體路徑認證， 打入高權限的帳號密碼即可
                   順便的，IIS寫檔案不成功的問題也解了
    
  可能出現的問題:  畫面說程式有錯，但不能顯示明確原因
  解決方法:        把程式站源的web.config 也複製到c:\MIP\webc即可。


### 寫一個簡單的程式
  打開瀏覽器，網址打localhost/webc/webc.aspx，
  看到要求登入畫面，輸入帳密(admin,admin9)
  看到出現了上下兩個輸入框，
  在畫面下方的輸入框寫 show== hello world
  按[確定] 即可看到結果
  
### 寫一個簡單的加法， 或乘法
  在畫面下方的輸入框寫
    aabb==eval! 10+5
    ccdd==dateadd!!5
    show==aabb , ccdd
  按[確定]即可看到 15 逗點 今天加5天的日期
  
    show==eval!3*5
  按[確定]即可看到 15 
  
### 顯示九九乘法表
  在畫面下方的輸入框寫
    uuuu==1,2,3,4,5,6,7,8,9
    vvvv==1,2,3,4,5,6,7,8,9
    show==glu2v!uuuu!vvvv![ui]x[vi]=@{eval![ui]*[vi]}!td 
  按[確定]即可看到九九乘法表
     
###寫一個簡單的SQL
  在畫面下方的輸入框寫
    conndb==db36
    sqlcmd==select * from tbyy
  按[確定]即可看到 tbyy 的內容

###呼叫 DOS command  
  在畫面下方的輸入框寫 
  doscmd==
    echo 123 > c:\tmp\test2.txt
    echo 456 > c:\tmp\test3.txt
  按[確定]即可去 c:\tmp 看結果

   
### 輸入、計算、輸出
  所有的電腦程式都可分解為(輸入、計算、輸出)三段，在MIP如何表達呢?
 
  在畫面上方的輸入框寫 who==John        這就是輸入
  在畫面下方的輸入框寫 show==hello who  這就是計算
  按[確定]後，畫面出現 hello John       這就是輸出 輸出到螢幕上
  
  如果要輸出到檔案呢? 只要把下框文字改寫為:
    answer==hello who
    saveToFile, a123.txt ==answer 
  按[確定]就會輸出到檔案c:/MIP/webt/a123.txt 。 
  若電腦報有錯 說不能寫入，則要叫起IIS或檔案總管去修改權限，請看安裝說明段。
  
  (輸入、計算、輸出)三段都有了，想把以上的程式發給期他人使用，怎麼做?
  看到最下方有兩個系系的輸入框，分別填上 test2.mip 和 測試2，
  再按[save new]，網頁顯示存入完成
  再按[see spList]，網頁顯示功能列表，選[登出]按下去，網頁顯示請登入的畫面，
  輸入帳號密碼(0800,0809) 按[登入]，網頁就有一個[測試2]的超連結給使用者了

  
###呼叫更多功能
  要充分發揮MIP的功能，
  還需瞭解3清單設定:(程式清單、 使用者清單、 資料庫清單)，
  還需瞭解:(自定關鍵字、預設關鍵字、自定函數、預定函數)，
  最後瞭解:(洗字順序、待定字、一行內函數呼叫)，
  這樣MIP就介紹完整了，以下從清單設定開始說明。
  
  
###設定程式清單
  本軟體是一個功能平台，把眾多功能集合成清單顯示在一頁畫面上。
  若要編輯這個清單，可打開c:\MIP\webd\cSPlist.txt 看到如下內容:
    [td]  
    []功能段代號A, 功能段名稱A
        程式檔名1,   程式名稱1  
        程式檔名2,   程式名稱2  
    []功能段代號B, 功能段名稱B
        程式檔名3,   程式名稱3  
        程式檔名4,   程式名稱4 
  以[]開頭的這一行將全部程式分成幾個功能段，
  將來在cusList.txt可以設定某人只能操作幾個功能段
  以[td]開頭的這一行使功能清單向右換欄，以免清單往下太長。
 
###設定使用者清單
  本軟體可以管理使用者權限，
  打開c:\MIP\webd\cUSlist.txt
  每一行的欄位依序是姓名、帳號、密碼、 公司名稱、 部門名稱、 員工工號、 可允許使用的功能段、 通行碼1、 通行碼2
  本軟體可以允許多個公司多個部門的人員一起使用 所以要寫下 公司名稱 部門名稱 員工工號 
  若限制某人只能使用 某3個功能段 則在 _可允許使用的功能段_ 填寫3個功能段名稱， 例如 aa bb cc
  若限制某人只能使用 某固定機器1 和某機器2，  則本軟體會送一個內碼到那些機器，並把這內碼寫到通行碼1和通行碼2 這兩個欄位。


###設定資料庫清單
  打開c:\MIP\webd\cDBlist.txt 看到如下內容
     HOME       : ms    : some connection string1
     web122     : ms    : some connection string2
     webcdd     : ms    : some connection string3
  第一行宣告一個預設的資料庫，將來寫程式時 不宣告連接哪個資料庫 就是連接這一個       
  第二行宣告一個簡稱web122，以後只要說連接web122 本軟體就去連接 some connection string2 所描述的資料庫
  第三行宣告一個簡稱webcdd，以後只要說連接webcdd 本軟體就去連接 some connection string3 所描述的資料庫
  
  
### 程式預解順序
      當看到某一行是include==*** 則載入這一行的內容
      當看到某一行以/開頭 則這一行忽略 ， 例如某一行是 /a==1;;b==2 則這整行忽略
      當看到;; 則改為換行符號 但若這;;所在那一行有uvar則不要改   
      當看到include==aa.txt 則載入aa.txt的內容作為程式的一部分
      
### 程式運作順序
     (1)程式從第一行開始跑，MT把每一行的aa==bb視為是 (變數名,它的值)， 準備往下做文字置換 ，文字置換亦可稱為染色
     (2)當程式來到第i行例如ccc==ddd，則ddd會被(1~i-1)行的值染色
        當程式突然跳到第j行再繼續跑，則第j行被(1~i-1)行的值染色
                                     第j+1行被(1~i-1),j行的值染色
                                     第j+2行被(1~i-1),j,j+1行的值染色
                                     第j+3行被(1~i-1),j,j+1,j+2行的值染色
     (3)當程式來到第i行，上述的色都染好了，再加一動作: 把這一行裏的 []改為無
        []是什麼，它是遮罩，用來防止某些字被染。色都染完後遮罩可以拆除了，也就是把[]改為無
     (3)上述的色都染好後，若當前這一行是aaa==func! parameter1 ! parameter2 這種型態，表示等號右方是一個function，那麼
          MT將解這function 送給aaa
          若aaa是個預設動詞 則MT會執行這個動詞。
        
        例如有程式碼如下
          aa==add!1!2
        則這句子將解成aa==3
        
        例如有程式碼如下
          show==add!1!2
        則這句子將解成show==3 ，show是預設動詞，於是MT動作，在畫面上顯示3
        
     (4)前解開: @{}
        如果function內的parameter想放一個未解的函數
        例如     aa==add! 1 ! @{add!2!3}    這例子中 @唸作call 就是呼叫的意思， 於是@{}先被解開，
        於是得到 aa==add! 1 ! 5
        最後得到 aa==6
        
        又例如          aa==glu1v!x1,x2,x3! [vi]=@{add!1!2}
        @{}先解開，得到 aa==glu1v!x1,x2,x3! [vi]=3          ，而此處glu1v是一個處理向量(x1,x2,x3)的黏膠函數
        最後得到        aa==x1=3,x2=3,x3=3
        
     (5)後解開: @{}
        如果function內的parameter想放一個未解的函數，但function執行過後才要解開呢
        例如                     aa==glu1v!1,2,3! y=@{add![vi]!4}           ，此處add裏有不定詞[vi]，稍後才解開，
        於是主函數glu1v先跑，得到aa==y=@{add!1!4},y=@{add!2!4},y=@{add!3!4}
        接著才去解@{}，  於是得到aa==y=5,y=6,y=7
        什麼樣的字會被當作不定詞呢? 就是 fdv,[ui], [vi], mi1,mi2,mi3,mi4,mi5,mi6,mi7 
        凡是一個字裏有這些符號都會被當作不定詞，凡是不定詞都是主函數解完才被解開
        
        
     (6)矩陣可以被別人染色 但不能去染別人 
        例如    kk==3
                matrix2==
                 1,2,kk
                 4,5,6
        則矩陣內儲值將會是
                matrix2==
                 1,2,3
                 4,5,6        
        這矩陣內的值被染掉了。
        反過來如果矩陣想去染別人例如
                matrix2==
                  1,2,3
                  4,5,6
                show==say(matrix2)
                    
        則螢幕會顯示 say(matrix2) ，不會顯示 say(1,2,3,4,5,6)
        凡是以matrix開頭的詞只能被別人染色，不能去染別人
        這麼作是為了處理大型矩陣的效率
                
###預先定義好的字 舉例  
        #userID  這個字將被轉換成 你現在的帳號
        #enter   這個字將被轉換成 換行符號 
        #space   這個字將被轉換成 空白一格

###預先定義好的關鍵字 舉例    
   預先定義好的關鍵字會促使電腦做事
   例如下面這關鍵字sqlcmd ，將發送一段SQL給資料庫引擎，這一段SQL可能含有多個句子。發送前會先把okclick改成onclick
    sqlcmd==
	    some_SQL1;
		some_SQL2;
		some_SQL3;
		
	例如下面這關鍵字saveToFile ，將多行文字存到檔案fcc.txt裏
    saveToFile,fcc.txt==
        this is fcc line1
        this is fcc line2
        
	例如下面這關鍵字addString ，將多次收集文字以方便最後存到檔案裏
    addString,paragraph99_txt ==123
    addString,paragraph99_txt ==456
    saveToFile,paragraph99.txt==paragraph99_txt  
                   
### 預先定義好的函數 舉例                   
        若有程式碼如下
          showHtm==add!1!2
		畫面將顯示3
		也就是說add是一個函數，函數的參數以!分隔，這樣設計是因為允許逗點也是參數的內容
		  
        
                
### 置換預設值
        若有程式碼如下
           moreWord==hello                               
           comment==the following is a ready module
           cc==add!1!2
           moreWord==hi
           showHtm==cc, moreWord John
        此程式碼第一行的moreWord往下置換，於是第二行comment不變，第三行變成cc==3，第四行不變            ，第五行變成showhtm==cc, hello John 
        此程式碼第二行的comment 往下置換，於是                   第三行cc不變   ，第四行不變            ，第五行不變
        此程式碼第三行的cc      往下置換，於是                                    第四行不變            ，第五行變成showhtm==3, hello John 
        此程式碼第四行的moreWord往下置換，下方已無moreWord字眼，                  所以                  ，第五行仍是showhtm==3, hello John 
        也就是moreWord出現兩次，只有第一個發生效果，第二個是預設值現在失效。
		當第二行以下是固定模組時，這方法可以用來改變預設值。

		
                         
###查詢資料庫資料

###新增多筆資料

###新增一筆資料

###刪除一筆資料

###修改一筆資料

###增刪修查一起工作

###顯示資料直轉橫(顯示樞紐報表)

###多維度靈活查詢

### 操作DB的指令: 延伸的SQL指令
       sqlcmd==select t='0922334455'              -- 這是常見的SQL 指令
       sqlcmd==select t='SQLF{mobiTEL$922334455}' -- 這是延伸的SQL 指令
               在執行SQL語句之前，本軟體發現 SQLF{***} ， 它開始解析這一字串
               它會把SQLF{mobiTEL$922334455}  分解為 主詞mobiTEL 受詞922334455  ，最後轉換成 0922334455
               它會把SQLF{mobiTEL$0922334455} 分解為 主詞mobiTEL 受詞0922334455 ，最後轉換成 0922334455
       
       SQLF{ifex$***}
       SQLF{ifnex$***}
       SQLF{equal$***}
       SQLF{range$***}
       SQLF{red$***} 將轉換成 <font color=red>***</font>

### 跨資料庫傳輸: 把文字檔轉入DB
            dataFrom
            dataTo
            dataToTable

### 跨資料庫傳輸: 經記憶體傳輸資料
### 跨資料庫傳輸: 經檔案多批次傳輸資料

### 呼叫外界: 發信
### 呼叫外界: 發簡訊
### 呼叫外界: URL get, post
### 呼叫外界: ftp
### 呼叫外界: 呼叫window command 或呼叫exe

### 被外界呼叫: URL get,post
### 被外界呼叫: 被VB, 被排程器

### 顯示畫面的修飾
   下面這一行 在應用模式下 會顯示成 aa: 後面帶一個輸入框 長度20
       aa==hello
	   
   下面這一行 在應用模式下 會顯示成 aa: 後面帶一個輸入框  框之右方有提示文字 say anything
       aa==hello $; say anything 
	   
   下面這一行 在應用模式下 會顯示成 aa: 後面帶一個輸入框  框之右方有提示文字 say anything 而框的長度拉長為30
       aa==hello $; say anything $; 30
	   
   下面這一行 在應用模式下 會顯示成 aa: 後面帶一個輸入框  框之右方有提示文字 say anything 而框的長度拉長為30
       aa         ==hello      $;  say anything $; ii~30
	   key        ==value      $;  explainWord  $; typeWord   ( typeWord could be   "epwd"    "iibx"    "iib2"    "entr"    "hidn"    "mmbx"    "comb"   "ckbx"  )
	   ikey(cmNxy)  ival(cmNxy)    imrk(cmNxy)     ptyps(cmNxy) 
	   
	   
